sudo: false
language: cpp
compiler:
  - gcc

install:
  - if [ "$CXX" = "g++" ]; then export CXX="g++-4.8" CC="gcc-4.8"; fi

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - gcc-4.8
      - g++-4.8
      - lcov
      - ruby-coveralls

script: 
  - cmake -DWIGWAG_COVERAGE=TRUE .
  - make
  - ./bin/wigwag_test

after_success:
  - lcov --directory . --capture --output-file coverage.info
  - lcov --remove coverage.info 'test/*' '/usr/*' --output-file coverage.info
  - lcov --list coverage.info
  - coveralls-lcov --repo-token ${COVERALLS_TOKEN} coverage.info
